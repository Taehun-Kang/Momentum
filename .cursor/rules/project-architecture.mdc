---
description: 
globs: 
alwaysApply: true
---
---
rule_type: user_rules
priority: medium
---

# ğŸ“ í”„ë¡œì íŠ¸ ì•„í‚¤í…ì²˜ ê°€ì´ë“œ

## ğŸ—ï¸ ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ê¸°ìˆ  ìŠ¤íƒ
- **ë°±ì—”ë“œ**: Node.js + Express.js
- **í”„ë¡ íŠ¸ì—”ë“œ**: Vanilla JavaScript SPA (No Framework)
- **ë°ì´í„°ë² ì´ìŠ¤**: Supabase (PostgreSQL)
- **ì¸ì¦**: Supabase Auth
- **ë°°í¬**: Railway
- **AI í†µí•©**: Claude API (MCP)

### í”„ë¡œì íŠ¸ êµ¬ì¡°
```
Youtube/
â”œâ”€â”€ backend/                    # ë°±ì—”ë“œ ì„œë²„
â”‚   â”œâ”€â”€ server.js              # ë©”ì¸ ì„œë²„ íŒŒì¼
â”‚   â”œâ”€â”€ routes/                # API ë¼ìš°íŠ¸
â”‚   â”‚   â”œâ”€â”€ searchRoutes.js    # ê²€ìƒ‰ ê´€ë ¨ API
â”‚   â”‚   â”œâ”€â”€ trendRoutes.js     # íŠ¸ë Œë“œ ê´€ë ¨ API
â”‚   â”‚   â””â”€â”€ llmRoutes.js       # LLM ê°ì„± ë¶„ì„ API
â”‚   â”œâ”€â”€ services/              # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ search/            # ê²€ìƒ‰ ì„œë¹„ìŠ¤
â”‚   â”‚   â”œâ”€â”€ video/             # ì˜ìƒ ì²˜ë¦¬ ì„œë¹„ìŠ¤
â”‚   â”‚   â””â”€â”€ llm/               # LLM ì„œë¹„ìŠ¤
â”‚   â””â”€â”€ youtube-ai-services/   # YouTube AI ëª¨ë“ˆ
â”‚       â”œâ”€â”€ search/            # ê²€ìƒ‰ ì—”ì§„
â”‚       â”œâ”€â”€ llm/               # LLM ë¶„ë¥˜ê¸°
â”‚       â”œâ”€â”€ keywords/          # í‚¤ì›Œë“œ ê´€ë¦¬
â”‚       â””â”€â”€ trends/            # íŠ¸ë Œë“œ ë¶„ì„
â”œâ”€â”€ frontend/                  # í”„ë¡ íŠ¸ì—”ë“œ SPA
â”‚   â”œâ”€â”€ index.html             # ë©”ì¸ HTML
â”‚   â”œâ”€â”€ js/                    # JavaScript ëª¨ë“ˆ
â”‚   â”‚   â”œâ”€â”€ app.js             # ì•± ì§„ì…ì 
â”‚   â”‚   â”œâ”€â”€ router.js          # Hash ê¸°ë°˜ ë¼ìš°í„°
â”‚   â”‚   â”œâ”€â”€ store.js           # ìƒíƒœ ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ components/        # UI ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â””â”€â”€ pages/             # í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ css/                   # ìŠ¤íƒ€ì¼ì‹œíŠ¸
â”‚   â””â”€â”€ assets/                # ì •ì  ìì‚°
â”œâ”€â”€ shared/                    # ê³µí†µ ìœ í‹¸ë¦¬í‹°
â”œâ”€â”€ test-lab/                  # ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
â””â”€â”€ docs/                      # í”„ë¡œì íŠ¸ ë¬¸ì„œ
```

## ğŸ’» ì½”ë”© ìŠ¤íƒ€ì¼ ê°€ì´ë“œ

### JavaScript ìŠ¤íƒ€ì¼
```javascript
// âœ… ê¶Œì¥: ES6+ ë¬¸ë²• ì‚¬ìš©
const searchResults = await searchAPI.query(keyword);
const filteredVideos = videos.filter(video => video.isPlayable);

// âœ… ê¶Œì¥: ëª…í™•í•œ í•¨ìˆ˜ëª…
async function getPlayableYouTubeShorts(keyword) {
  // êµ¬í˜„
}

// âœ… ê¶Œì¥: ì—ëŸ¬ ì²˜ë¦¬ í¬í•¨
try {
  const result = await apiCall();
  return { success: true, data: result };
} catch (error) {
  console.error('API í˜¸ì¶œ ì‹¤íŒ¨:', error);
  return { success: false, error: error.message };
}
```

### API ì‘ë‹µ í˜•ì‹ í‘œì¤€í™”
```javascript
// ì„±ê³µ ì‘ë‹µ
{
  "success": true,
  "message": "ê²€ìƒ‰ ì™„ë£Œ",
  "data": { /* ì‹¤ì œ ë°ì´í„° */ },
  "timestamp": "2025-01-01T00:00:00.000Z"
}

// ì—ëŸ¬ ì‘ë‹µ
{
  "success": false,
  "error": "API í• ë‹¹ëŸ‰ ì´ˆê³¼",
  "code": "QUOTA_EXCEEDED",
  "timestamp": "2025-01-01T00:00:00.000Z"
}
```

## ğŸ¨ í”„ë¡ íŠ¸ì—”ë“œ ì•„í‚¤í…ì²˜

### Vanilla JS SPA íŒ¨í„´
```javascript
// Component ê¸°ë°˜ êµ¬ì¡° (Web Components ì•„ë‹˜!)
class VideoCard extends Component {
  constructor(props) {
    super(props);
    this.state = { liked: false };
  }
  
  render() {
    return `<div class="video-card">...</div>`;
  }
  
  mount() {
    this.bindEvents();
  }
}

// Store íŒ¨í„´ìœ¼ë¡œ ìƒíƒœ ê´€ë¦¬
class VideoStore extends Store {
  constructor() {
    super();
    this.videos = [];
    this.loading = false;
  }
  
  async searchVideos(keyword) {
    this.setState({ loading: true });
    const result = await api.searchVideos(keyword);
    this.setState({ videos: result.data, loading: false });
  }
}

// Hash ê¸°ë°˜ ë¼ìš°íŒ…
const router = new Router({
  '/': HomePage,
  '/search': SearchPage,
  '/trending': TrendingPage
});
```

### CSS êµ¬ì¡°í™”
```css
/* CSS Variables ì‚¬ìš© */
:root {
  --primary-color: #1a73e8;
  --secondary-color: #34a853;
  --text-color: #202124;
  --bg-color: #ffffff;
}

/* ëª¨ë“ˆí™”ëœ ì»´í¬ë„ŒíŠ¸ ìŠ¤íƒ€ì¼ */
.video-card {
  display: flex;
  flex-direction: column;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

/* ë°˜ì‘í˜• ë””ìì¸ */
@media (max-width: 768px) {
  .video-grid {
    grid-template-columns: 1fr;
  }
}
```

## ğŸ”§ ë°±ì—”ë“œ ì„œë¹„ìŠ¤ íŒ¨í„´

### ì„œë¹„ìŠ¤ ë ˆì´ì–´ êµ¬ì¡°
```javascript
// services/search/youtubeSearchService.js
class YouTubeSearchService {
  constructor() {
    this.apiKey = process.env.YOUTUBE_API_KEY;
    this.quotaManager = new QuotaManager();
  }
  
  async searchShorts(keyword, options = {}) {
    // 1. í• ë‹¹ëŸ‰ í™•ì¸
    await this.quotaManager.checkQuota();
    
    // 2. ê²€ìƒ‰ ì‹¤í–‰
    const searchResult = await this.performSearch(keyword, options);
    
    // 3. í•„í„°ë§
    const filteredResult = await this.filterPlayableVideos(searchResult);
    
    // 4. ì‚¬ìš©ëŸ‰ ê¸°ë¡
    await this.quotaManager.recordUsage(searchResult.unitsUsed);
    
    return filteredResult;
  }
}
```

### ì—ëŸ¬ ì²˜ë¦¬ ë¯¸ë“¤ì›¨ì–´
```javascript
// middleware/errorHandler.js
function errorHandler(error, req, res, next) {
  console.error('API ì—ëŸ¬:', error);
  
  if (error.code === 'QUOTA_EXCEEDED') {
    return res.status(429).json({
      success: false,
      error: 'API í• ë‹¹ëŸ‰ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤',
      code: 'QUOTA_EXCEEDED'
    });
  }
  
  res.status(500).json({
    success: false,
    error: 'ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜',
    code: 'INTERNAL_ERROR'
  });
}
```

## ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### í…Œì´ë¸” ëª…ëª… ê·œì¹™
- **í…Œì´ë¸”ëª…**: `snake_case`, ë³µìˆ˜í˜• ì‚¬ìš©
- **ì»¬ëŸ¼ëª…**: `snake_case`, ëª…í™•í•˜ê³  ê°„ê²°í•˜ê²Œ
- **ì¸ë±ìŠ¤ëª…**: `idx_{table}_{column(s)}`

### í•„ìˆ˜ ì»¬ëŸ¼ íŒ¨í„´
```sql
-- ëª¨ë“  í…Œì´ë¸”ì— í¬í•¨
id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
created_at timestamptz DEFAULT now() NOT NULL,
updated_at timestamptz DEFAULT now() NOT NULL
```

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì „ëµ

### test-lab í™œìš©
```
test-lab/
â”œâ”€â”€ youtube-api/           # YouTube API ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ mcp-integration/       # MCP ì—°ë™ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ component-tests/       # í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸
â””â”€â”€ e2e-scenarios/         # ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸
```

### í…ŒìŠ¤íŠ¸ ìš°ì„ ìˆœìœ„
1. **API ì—°ë™ í…ŒìŠ¤íŠ¸** (YouTube, Claude)
2. **í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§** (í•„í„°ë§, ë¶„ë¥˜)
3. **UI ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸**
4. **í†µí•© í…ŒìŠ¤íŠ¸**

## ğŸ“ ì½”ë“œ í’ˆì§ˆ ê¸°ì¤€

### í•„ìˆ˜ ì²´í¬ì‚¬í•­
- [ ] ëª¨ë“  API í˜¸ì¶œì— ì—ëŸ¬ ì²˜ë¦¬
- [ ] í• ë‹¹ëŸ‰ ì¶”ì  ë° ì œí•œ
- [ ] ìºì‹± ì „ëµ ì ìš©
- [ ] ë°˜ì‘í˜• UI êµ¬í˜„
- [ ] ì ‘ê·¼ì„± ê³ ë ¤ (a11y)

### ì„±ëŠ¥ ê¸°ì¤€
- **API ì‘ë‹µ ì‹œê°„**: < 500ms
- **í˜ì´ì§€ ë¡œë“œ ì‹œê°„**: < 2ì´ˆ
- **ìºì‹œ ì ì¤‘ë¥ **: > 85%
- **ëª¨ë°”ì¼ í˜¸í™˜ì„±**: 100%

## ì°¸ì¡°
- [ì„œë²„ êµ¬ì¡° ê°€ì´ë“œ](mdc:<mdc:backend/server.js>)
- [ê²€ìƒ‰ ì„œë¹„ìŠ¤](mdc:<mdc:backend/services/search/>)
- [YouTube AI ëª¨ë“ˆ](mdc:<mdc:backend/youtube-ai-services/>)
- [í”„ë¡ íŠ¸ì—”ë“œ ê³„íš](mdc:<mdc:frontend/>)
