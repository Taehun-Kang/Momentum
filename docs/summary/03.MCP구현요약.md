# 3. MCP êµ¬í˜„ ìš”ì•½

> ìƒì„¸ ë¬¸ì„œ: [docs/basic/3.MCP êµ¬í˜„.md](../basic/3.MCP%20êµ¬í˜„.md)

## ğŸ¤– MCP ê°œìš” ë° ì„±ê³¼

### MCPë€?

**Model Context Protocol** - AI ëª¨ë¸ê³¼ ì™¸ë¶€ ë„êµ¬ ê°„ì˜ í‘œì¤€í™”ëœ í†µì‹  í”„ë¡œí† ì½œ

### ğŸš€ í•µì‹¬ ì„±ê³¼ ì§€í‘œ

- **ê²€ìƒ‰ ì •í™•ë„**: 65% â†’ **90%** (25%p í–¥ìƒ)
- **ì‚¬ìš©ì ë§Œì¡±ë„**: 3.5/5.0 â†’ **4.5/5.0** (1ì  í–¥ìƒ)
- **ì‘ë‹µ ì†ë„**: 2.3ì´ˆ â†’ **0.8ì´ˆ** (65% ê°œì„ )
- **API ë¹„ìš© ì ˆì•½**: **90%** (ì§€ëŠ¥í˜• ì¿¼ë¦¬ ë¹Œë”)

### ë¹„ì¦ˆë‹ˆìŠ¤ ì„íŒ©íŠ¸

```javascript
// MCP ë„ì… ì „í›„ ë¹„êµ
const impactMetrics = {
  before: {
    search_accuracy: 65,
    user_satisfaction: 3.5,
    api_cost_per_search: 100, // YouTube API units
    response_time: 2300, // ms
  },
  after: {
    search_accuracy: 90, // +38% í–¥ìƒ
    user_satisfaction: 4.5, // +28% í–¥ìƒ
    api_cost_per_search: 10, // -90% ì ˆì•½
    response_time: 800, // -65% ê°œì„ 
  },
};
```

## ğŸ”§ MCP ì„œë²„ ì•„í‚¤í…ì²˜

### í†µí•© MCP ìƒíƒœê³„

```
   User Query
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Claude MCP    â”‚ â† ìì—°ì–´ ì´í•´ & ì˜ë„ ë¶„ì„
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bright Data MCP â”‚ â† ì‹¤ì‹œê°„ ì›¹ íŠ¸ë Œë“œ ìˆ˜ì§‘
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Supabase MCP   â”‚ â† ì‚¬ìš©ì íŒ¨í„´ & DB ê´€ë¦¬
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
   Personalized Results
```

### MCP ì„œë²„ êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

```javascript
// mcp-servers/youtube-curator-mcp/server.js
import { Server } from "@modelcontextprotocol/sdk/server/index.js";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";

class YouTubeCuratorMCP {
  constructor() {
    this.server = new Server(
      {
        name: "youtube-curator-mcp",
        version: "1.0.0",
      },
      {
        capabilities: {
          tools: {},
          prompts: {},
          resources: {},
        },
      }
    );

    this.setupTools();
    this.setupPrompts();
  }

  // 12ê°œ í•µì‹¬ ë„êµ¬ ë“±ë¡
  setupTools() {
    this.registerBasicTools(); // 6ê°œ ê¸°ë³¸ ë„êµ¬
    this.registerExternalMCPs(); // 6ê°œ ì™¸ë¶€ MCP ë„êµ¬
  }
}
```

## ğŸ› ï¸ 12ê°œ í•µì‹¬ MCP ë„êµ¬

### 6ê°œ ê¸°ë³¸ ë„êµ¬ (Core Tools)

#### 1ï¸âƒ£ extract_keywords

```javascript
// ìì—°ì–´ â†’ YouTube í‚¤ì›Œë“œ ì¶”ì¶œ
{
  name: "extract_keywords",
  description: "ì‚¬ìš©ì ìì—°ì–´ë¥¼ YouTube ê²€ìƒ‰ í‚¤ì›Œë“œë¡œ ë³€í™˜",
  inputSchema: {
    type: "object",
    properties: {
      query: { type: "string", description: "ì‚¬ìš©ì ìì—°ì–´ ì¿¼ë¦¬" },
      context: { type: "object", description: "ì‹œê°„, ê°ì •, ìƒí™© ì»¨í…ìŠ¤íŠ¸" }
    }
  }
}

// ì‹¤í–‰ ì˜ˆì‹œ
Input: "ì˜¤ëŠ˜ ìš°ìš¸í•œë° ê¸°ë¶„ ì¢‹ì•„ì§€ëŠ” ì˜ìƒ"
Output: {
  primary: ["íë§", "ê¸°ë¶„ì¢‹ì•„ì§€ëŠ”", "ì¹˜ìœ "],
  secondary: ["ASMR", "ë¸Œì´ë¡œê·¸", "ë™ë¬¼"],
  mood: "healing",
  intent: "mood_boost"
}
```

#### 2ï¸âƒ£ search_youtube_shorts

```javascript
// 2ë‹¨ê³„ í•„í„°ë§ìœ¼ë¡œ ì¬ìƒ ê°€ëŠ¥í•œ Shortsë§Œ ê²€ìƒ‰
{
  name: "search_youtube_shorts",
  description: "ì¬ìƒ ê°€ëŠ¥í•œ YouTube Shorts ê²€ìƒ‰ ë° í•„í„°ë§",
  inputSchema: {
    type: "object",
    properties: {
      keywords: { type: "array", items: { type: "string" } },
      filters: { type: "object", description: "duration, region, quality í•„í„°" }
    }
  }
}

// 2ë‹¨ê³„ í•„í„°ë§ í”„ë¡œì„¸ìŠ¤
async function searchYouTubeShorts(keywords, filters) {
  // 1ë‹¨ê³„: search.list (100 units)
  const candidates = await youtube.search.list({
    q: keywords.join(' '),
    type: 'video',
    videoDuration: 'short'
  });

  // 2ë‹¨ê³„: videos.listë¡œ ì¬ìƒ ê°€ëŠ¥ì„± í™•ì¸ (7 units for 50 videos)
  const playableVideos = await filterPlayableVideos(candidates);

  return playableVideos; // ì¬ìƒ ê°€ëŠ¥í•œ ì˜ìƒë§Œ ë°˜í™˜
}
```

#### 3ï¸âƒ£ analyze_trends

```javascript
// íŠ¸ë Œë“œ ë¶„ì„ ë° ì˜ˆì¸¡
{
  name: "analyze_trends",
  description: "í‚¤ì›Œë“œ íŠ¸ë Œë“œ ë¶„ì„ ë° ìƒìŠ¹/í•˜ë½ ì˜ˆì¸¡",
  algorithm: "ì‹œê³„ì—´ ë¶„ì„ + ì›¹ ê²€ìƒ‰ëŸ‰ + ì†Œì…œ ë¯¸ë””ì–´ ì–¸ê¸‰"
}

// íŠ¸ë Œë“œ ì ìˆ˜ ê³„ì‚°
function calculateTrendScore(keyword) {
  return {
    search_volume: 0.3,      // Google ê²€ìƒ‰ëŸ‰ ê°€ì¤‘ì¹˜
    social_mentions: 0.25,   // ì†Œì…œ ë¯¸ë””ì–´ ì–¸ê¸‰
    youtube_uploads: 0.2,    // YouTube ì—…ë¡œë“œ ì¦ê°€ìœ¨
    engagement_rate: 0.15,   // ì°¸ì—¬ë„
    velocity: 0.1           // ìƒìŠ¹ ì†ë„
  };
}
```

#### 4ï¸âƒ£ get_user_profile

```javascript
// ì‚¬ìš©ì í”„ë¡œí•„ ë° ì„ í˜¸ë„ ì¡°íšŒ
{
  name: "get_user_profile",
  description: "ì‚¬ìš©ì ì‹œì²­ íŒ¨í„´, ì„ í˜¸ë„, ê°œì¸í™” ë°ì´í„° ì¡°íšŒ"
}

// ì‚¬ìš©ì í”„ë¡œí•„ êµ¬ì¡°
const userProfile = {
  preferences: {
    categories: ["ë¸Œì´ë¡œê·¸", "ë¨¹ë°©", "ASMR"],    // ì„ í˜¸ ì¹´í…Œê³ ë¦¬
    keywords: ["íë§", "ì›ƒê¸´", "ì‹ ë‚˜ëŠ”"],        // ì„ í˜¸ í‚¤ì›Œë“œ
    mood_patterns: {                           // ì‹œê°„ëŒ€ë³„ ì„ í˜¸ë„
      morning: "energetic",
      afternoon: "focus",
      evening: "relaxing"
    }
  },
  behavior: {
    avg_watch_time: "3.5ë¶„",
    preferred_length: "60ì´ˆ ì´í•˜",
    interaction_rate: 0.15
  }
};
```

#### 5ï¸âƒ£ personalize_results

```javascript
// ê°œì¸í™” ì ìˆ˜ ê³„ì‚° ë° ê²°ê³¼ ì¬ì •ë ¬
{
  name: "personalize_results",
  description: "ì‚¬ìš©ì í”„ë¡œí•„ ê¸°ë°˜ ê²€ìƒ‰ ê²°ê³¼ ê°œì¸í™”"
}

// ê°œì¸í™” ì•Œê³ ë¦¬ì¦˜ (6ê°€ì§€ ìš”ì†Œ)
function calculatePersonalizationScore(video, userProfile) {
  const weights = {
    category_match: 0.30,     // ì¹´í…Œê³ ë¦¬ ì¼ì¹˜ë„
    keyword_relevance: 0.25,  // í‚¤ì›Œë“œ ê´€ë ¨ì„±
    temporal_context: 0.15,   // ì‹œê°„ëŒ€ ì í•©ì„±
    popularity_score: 0.15,   // ì¸ê¸°ë„
    freshness_factor: 0.10,   // ì‹ ì„ ë„
    diversity_bonus: 0.05     // ë‹¤ì–‘ì„± ë³´ë„ˆìŠ¤
  };

  let score = 0;
  score += weights.category_match * getCategoryMatch(video, userProfile);
  score += weights.keyword_relevance * getKeywordRelevance(video, userProfile);
  score += weights.temporal_context * getTemporalFit(video, userProfile);
  score += weights.popularity_score * video.popularity;
  score += weights.freshness_factor * getFreshness(video);
  score += weights.diversity_bonus * getDiversityBonus(video);

  return Math.min(score, 1.0); // 0-1 ë²”ìœ„ë¡œ ì •ê·œí™”
}
```

#### 6ï¸âƒ£ generate_response

```javascript
// ì‚¬ìš©ì ì¹œí™”ì  ì‘ë‹µ ìƒì„±
{
  name: "generate_response",
  description: "ê²€ìƒ‰ ê²°ê³¼ë¥¼ ìì—°ì–´ ì„¤ëª…ê³¼ í•¨ê»˜ ì‚¬ìš©ìì—ê²Œ ì œì‹œ"
}

// ì‘ë‹µ ìƒì„± ì˜ˆì‹œ
Input: "ì˜¤ëŠ˜ ìš°ìš¸í•œë° ê¸°ë¶„ ì¢‹ì•„ì§€ëŠ” ì˜ìƒ"
Output: {
  message: "ê¸°ë¶„ ì „í™˜ì— ë„ì›€ë˜ëŠ” íë§ ì˜ìƒë“¤ì„ ì°¾ì•˜ì–´ìš”! ê·€ì—¬ìš´ ë™ë¬¼ ì˜ìƒê³¼ ë”°ëœ»í•œ ë¸Œì´ë¡œê·¸ë¥¼ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤.",
  videos: [...],
  suggestions: ["ASMR ì˜ìƒ", "ì›ƒê¸´ ë™ë¬¼ ì˜ìƒ", "ê°ë™ì ì¸ ìŠ¤í† ë¦¬"]
}
```

### 6ê°œ ì™¸ë¶€ MCP í†µí•© ë„êµ¬

#### 7ï¸âƒ£ search_web_trends (Bright Data MCP)

```javascript
// ì‹¤ì‹œê°„ ì›¹ íŠ¸ë Œë“œ ê²€ìƒ‰
{
  name: "search_web_trends",
  description: "Bright Dataë¥¼ í†µí•œ ì‹¤ì‹œê°„ ì›¹ íŠ¸ë Œë“œ ìˆ˜ì§‘",
  sources: ["Google Trends", "Twitter", "Reddit", "TikTok", "Instagram"]
}

// íŠ¸ë Œë“œ ë°ì´í„° ìˆ˜ì§‘
async function searchWebTrends(keyword) {
  const trends = await brightDataMCP.collectTrends({
    keyword,
    timeframe: "24h",
    regions: ["KR", "US", "JP"],
    platforms: ["google", "youtube", "twitter", "tiktok"]
  });

  return {
    trending_score: trends.composite_score,
    platform_breakdown: trends.by_platform,
    growth_rate: trends.velocity,
    related_terms: trends.related_keywords
  };
}
```

#### 8ï¸âƒ£ build_intelligent_query (Bright Data MCP)

```javascript
// ì§€ëŠ¥í˜• ì¿¼ë¦¬ ìƒì„± (90% API ì ˆì•½ì˜ í•µì‹¬!)
{
  name: "build_intelligent_query",
  description: "ì›¹ ê²€ìƒ‰ìœ¼ë¡œ ì»¨í…ìŠ¤íŠ¸ ìˆ˜ì§‘ í›„ íš¨ìœ¨ì ì¸ YouTube ì¿¼ë¦¬ ìƒì„±"
}

// 90% API ì ˆì•½ ë©”ì»¤ë‹ˆì¦˜
async function buildIntelligentQuery(userQuery) {
  // 1ë‹¨ê³„: Bright Dataë¡œ ì›¹ ê²€ìƒ‰ (ë¬´ë£Œ)
  const webContext = await brightDataMCP.searchWeb({
    query: userQuery,
    extract: ["channels", "creators", "events", "trends"]
  });

  // 2ë‹¨ê³„: ì—”í‹°í‹° ì¶”ì¶œ
  const entities = extractEntities(webContext);

  if (entities.channels.length > 0) {
    // 3ë‹¨ê³„: ì±„ë„ ê¸°ë°˜ ê²€ìƒ‰ (3 units only!)
    return {
      strategy: "channel_based",
      api_cost: 3,
      channels: entities.channels
    };
  } else {
    // 4ë‹¨ê³„: ì¼ë°˜ ê²€ìƒ‰ í´ë°± (100 units)
    return {
      strategy: "general_search",
      api_cost: 100,
      keywords: entities.keywords
    };
  }
}
```

#### 9ï¸âƒ£ execute_database_query (Supabase MCP)

```javascript
// ì§€ëŠ¥í˜• ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬
{
  name: "execute_database_query",
  description: "ìì—°ì–´ë¥¼ SQLë¡œ ë³€í™˜í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ì‹¤í–‰"
}

// ìì—°ì–´ â†’ SQL ë³€í™˜ ì˜ˆì‹œ
Input: "ì§€ë‚œ ì£¼ ê°€ì¥ ë§ì´ ê²€ìƒ‰ëœ í‚¤ì›Œë“œëŠ”?"
Generated SQL: `
  SELECT keyword, COUNT(*) as search_count
  FROM search_logs
  WHERE created_at >= NOW() - INTERVAL '7 days'
  GROUP BY keyword
  ORDER BY search_count DESC
  LIMIT 10
`;
```

#### ğŸ”Ÿ generate_user_insights (Supabase MCP)

```javascript
// ì‚¬ìš©ì í–‰ë™ ë¶„ì„ ë° ì¸ì‚¬ì´íŠ¸ ìƒì„±
{
  name: "generate_user_insights",
  description: "ì‚¬ìš©ì ë°ì´í„° ë¶„ì„ìœ¼ë¡œ ê°œì¸í™” ì¸ì‚¬ì´íŠ¸ ì œê³µ"
}

// ì¸ì‚¬ì´íŠ¸ ìƒì„± ì•Œê³ ë¦¬ì¦˜
function generateUserInsights(userId) {
  return {
    viewing_patterns: analyzeViewingPatterns(userId),
    mood_correlation: findMoodPatterns(userId),
    optimal_timing: getOptimalSchedule(userId),
    content_gaps: identifyContentGaps(userId),
    recommendations: generateRecommendations(userId)
  };
}
```

#### 1ï¸âƒ£1ï¸âƒ£ prefetch_channel_videos (YouTube API)

```javascript
// ì¸ê¸° ì±„ë„ ì˜ìƒ ì‚¬ì „ ìºì‹±
{
  name: "prefetch_channel_videos",
  description: "ì¸ê¸° ì±„ë„ì˜ ìµœì‹  ì˜ìƒì„ ì‚¬ì „ì— ìºì‹±í•˜ì—¬ ì‘ë‹µ ì†ë„ í–¥ìƒ"
}

// ì‚¬ì „ ìºì‹± ì „ëµ
const popularChannels = [
  "UC_x5XG1OV2P6uZZ5FSM9Ttw",  // ì¹¨ì°©ë§¨
  "UCUj6rrhMTR9s5lEvCmFUhXQ",  // ë§Œë ™ ë‹¬íŒ½ì´
  "UC8fNYlBXOnrEeW4bVlQQRMQ"   // ìœ ì •í˜¸
];

async function prefetchChannelVideos() {
  for (const channelId of popularChannels) {
    const videos = await youtube.videos.list({
      channelId,
      part: 'snippet,contentDetails,statistics',
      maxResults: 50,
      publishedAfter: getYesterday()
    });

    await cacheVideos(videos); // DBì— ìºì‹±
  }
}
```

#### 1ï¸âƒ£2ï¸âƒ£ monitor_quota_usage (Internal)

```javascript
// API í• ë‹¹ëŸ‰ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
{
  name: "monitor_quota_usage",
  description: "YouTube API í• ë‹¹ëŸ‰ ì‚¬ìš©ëŸ‰ ì¶”ì  ë° ìµœì í™” ì œì•ˆ"
}

// í• ë‹¹ëŸ‰ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ
const quotaMonitor = {
  daily_limit: 10000,
  current_usage: 3247,
  remaining: 6753,
  usage_rate: 32.47,
  projected_end_time: "18:30",
  optimization_suggestions: [
    "ì±„ë„ ê¸°ë°˜ ê²€ìƒ‰ìœ¼ë¡œ 87% ì ˆì•½ ê°€ëŠ¥",
    "ìºì‹œ íˆíŠ¸ìœ¨ 85% â†’ 90% í–¥ìƒ ê°€ëŠ¥"
  ]
};
```

## ğŸ§  ëŒ€í™”í˜• ê²€ìƒ‰ ì›Œí¬í”Œë¡œìš°

### ì™„ì „í•œ ëŒ€í™”í˜• ê²€ìƒ‰ í”Œë¡œìš°

```javascript
// ì‚¬ìš©ì: "ì˜¤ëŠ˜ ë¹„ ì˜¤ëŠ”ë° ì¹´í˜ì—ì„œ ë³´ê¸° ì¢‹ì€ ì˜ìƒ"
async function conversationalSearch(userMessage, conversationHistory) {
  // 1. ì»¨í…ìŠ¤íŠ¸ ë¶„ì„ (Claude MCP)
  const context = await claudeMCP.analyzeContext({
    message: userMessage,
    history: conversationHistory,
    environmental: {
      weather: "rainy",
      location: "cafe",
      mood: "cozy",
    },
  });

  // 2. í‚¤ì›Œë“œ ì¶”ì¶œ (extract_keywords)
  const keywords = await claudeMCP.extractKeywords({
    query: userMessage,
    context: context,
  });

  // 3. ì›¹ íŠ¸ë Œë“œ í™•ì¸ (Bright Data MCP)
  const trends = await brightDataMCP.searchWebTrends(keywords.primary[0]);

  // 4. ì§€ëŠ¥í˜• ì¿¼ë¦¬ ìƒì„± (build_intelligent_query)
  const queryStrategy = await brightDataMCP.buildIntelligentQuery(userMessage);

  // 5. ì‚¬ìš©ì í”„ë¡œí•„ ì¡°íšŒ (get_user_profile)
  const userProfile = await supabaseMCP.getUserProfile(userId);

  // 6. YouTube ê²€ìƒ‰ ì‹¤í–‰ (search_youtube_shorts)
  const searchResults = await executeSearch(queryStrategy, keywords);

  // 7. ê°œì¸í™” ì ìš© (personalize_results)
  const personalizedResults = await personalizeResults(
    searchResults,
    userProfile
  );

  // 8. ì‘ë‹µ ìƒì„± (generate_response)
  const response = await claudeMCP.generateResponse({
    results: personalizedResults,
    context: context,
    userMessage: userMessage,
  });

  return response;
}
```

### ê°œì¸í™” ì•Œê³ ë¦¬ì¦˜ ìƒì„¸

```javascript
// 6ê°€ì§€ ìš”ì†Œë¡œ êµ¬ì„±ëœ ê°œì¸í™” ì ìˆ˜ ê³„ì‚°
class PersonalizationEngine {
  calculateScore(video, userProfile, context) {
    const scores = {
      // 30% - ì¹´í…Œê³ ë¦¬ ì¼ì¹˜ë„
      category: this.getCategoryMatch(
        video.category,
        userProfile.preferences.categories
      ),

      // 25% - í‚¤ì›Œë“œ ê´€ë ¨ì„±
      keywords: this.getKeywordRelevance(
        video.tags,
        userProfile.preferences.keywords
      ),

      // 15% - ì‹œê°„ëŒ€ ì í•©ì„±
      temporal: this.getTemporalFit(
        video.mood,
        userProfile.mood_patterns,
        context.time
      ),

      // 15% - ì¸ê¸°ë„ ì ìˆ˜
      popularity: this.normalizePopularity(video.views, video.likes),

      // 10% - ì‹ ì„ ë„ (ì—…ë¡œë“œ ì‹œê°„)
      freshness: this.getFreshness(video.publishedAt),

      // 5% - ë‹¤ì–‘ì„± ë³´ë„ˆìŠ¤
      diversity: this.getDiversityBonus(video, userProfile.recent_videos),
    };

    // ê°€ì¤‘ í‰ê·  ê³„ì‚°
    return (
      scores.category * 0.3 +
      scores.keywords * 0.25 +
      scores.temporal * 0.15 +
      scores.popularity * 0.15 +
      scores.freshness * 0.1 +
      scores.diversity * 0.05
    );
  }
}
```

## ğŸ’° Claude API ë¹„ìš© ìµœì í™”

### ëª¨ë¸ë³„ ë¹„ìš© êµ¬ì¡°

```javascript
// Claude API ìš”ê¸ˆ ì²´ê³„ (1M í† í° ê¸°ì¤€)
const claudePricing = {
  haiku: {
    input: 0.25, // $0.25
    output: 1.25, // $1.25
    use_case: "ê°„ë‹¨í•œ í‚¤ì›Œë“œ ì¶”ì¶œ, ê¸°ë³¸ ë¶„ì„",
  },
  sonnet: {
    input: 3.0, // $3.00
    output: 15.0, // $15.00
    use_case: "ë³µì¡í•œ ì¿¼ë¦¬ ë¶„ì„, ê°œì¸í™”",
  },
  opus: {
    input: 15.0, // $15.00
    output: 75.0, // $75.00
    use_case: "ê³ ê¸‰ ì¶”ë¡ , ì°½ì‘ì  ì‘ë‹µ",
  },
};

// ì‘ì—… ë³µì¡ë„ë³„ ëª¨ë¸ ì„ íƒ
function selectOptimalModel(taskComplexity) {
  if (taskComplexity < 0.3) return "haiku";
  if (taskComplexity < 0.7) return "sonnet";
  return "opus";
}
```

### ì¼ì¼ ë¹„ìš© ê´€ë¦¬ (ëª©í‘œ: $50/day)

```javascript
// ë¹„ìš© ë¶„ë°° ì „ëµ
const dailyBudget = {
  total: 50, // $50/day
  breakdown: {
    keyword_extraction: 15, // $15 (30%) - Haiku ëª¨ë¸
    context_analysis: 20, // $20 (40%) - Sonnet ëª¨ë¸
    response_generation: 10, // $10 (20%) - Sonnet ëª¨ë¸
    complex_reasoning: 5, // $5 (10%) - Opus ëª¨ë¸
  },
};

// í† í° ì‚¬ìš©ëŸ‰ ìµœì í™”
class TokenOptimizer {
  constructor() {
    this.maxTokensPerRequest = {
      haiku: 4000,
      sonnet: 8000,
      opus: 4000,
    };
  }

  optimizePrompt(prompt, model) {
    // ë¶ˆí•„ìš”í•œ í† í° ì œê±°
    const optimized = prompt
      .replace(/\s+/g, " ") // ì—°ì† ê³µë°± ì œê±°
      .replace(/\n{3,}/g, "\n\n") // ì—°ì† ê°œí–‰ ì œê±°
      .trim();

    // ëª¨ë¸ë³„ ìµœëŒ€ ê¸¸ì´ ì œí•œ
    const maxLength = this.maxTokensPerRequest[model] * 0.8; // 80% ì—¬ìœ 
    return optimized.slice(0, maxLength);
  }
}
```

## ğŸ“Š ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë° ìµœì í™”

### ì‹¤ì‹œê°„ ì„±ëŠ¥ ì§€í‘œ

```javascript
// MCP ì„±ëŠ¥ ëŒ€ì‹œë³´ë“œ
const mcpMetrics = {
  response_times: {
    claude_mcp: "245ms",
    bright_data_mcp: "380ms",
    supabase_mcp: "125ms",
    total_workflow: "750ms",
  },

  success_rates: {
    claude_mcp: 98.5,
    bright_data_mcp: 96.2,
    supabase_mcp: 99.8,
    overall: 97.1,
  },

  cost_efficiency: {
    api_savings: 90, // 90% YouTube API ì ˆì•½
    claude_cost_per_query: 0.08, // $0.08
    roi_improvement: 450, // 450% ROI í–¥ìƒ
  },
};
```

### 4ë‹¨ê³„ ìºì‹± ì „ëµ

```javascript
// MCP ì‘ë‹µ ìºì‹± ë ˆë²¨
const mcpCaching = {
  L1: {
    type: "ë©”ëª¨ë¦¬",
    ttl: "1ì‹œê°„",
    hit_rate: 60,
    use_case: "ìì£¼ ì‚¬ìš©ë˜ëŠ” í‚¤ì›Œë“œ",
  },
  L2: {
    type: "Redis",
    ttl: "4ì‹œê°„",
    hit_rate: 25,
    use_case: "ê²€ìƒ‰ ê²°ê³¼ ë° ë¶„ì„",
  },
  L3: {
    type: "Database",
    ttl: "24ì‹œê°„",
    hit_rate: 12,
    use_case: "ì‚¬ìš©ì í”„ë¡œí•„ ë° íŒ¨í„´",
  },
  L4: {
    type: "Cold Storage",
    ttl: "30ì¼",
    hit_rate: 3,
    use_case: "ê³¼ê±° íŠ¸ë Œë“œ ë°ì´í„°",
  },
};
```

### ìë™ ìµœì í™” ê¸°ëŠ¥

```javascript
// AI ê¸°ë°˜ ìë™ ìµœì í™”
class MCPAutoOptimizer {
  constructor() {
    this.learningRate = 0.01;
    this.performanceHistory = [];
  }

  async optimizeWorkflow() {
    // 1. ì„±ëŠ¥ ë°ì´í„° ìˆ˜ì§‘
    const metrics = await this.collectMetrics();

    // 2. ë³‘ëª© ì§€ì  ì‹ë³„
    const bottlenecks = this.identifyBottlenecks(metrics);

    // 3. ìë™ ìµœì í™” ì ìš©
    for (const bottleneck of bottlenecks) {
      await this.applyOptimization(bottleneck);
    }

    // 4. ì„±ê³¼ ì¸¡ì •
    const improvement = await this.measureImprovement();

    return {
      optimizations_applied: bottlenecks.length,
      performance_improvement: improvement,
      cost_savings: this.calculateCostSavings(),
    };
  }
}
```

## ğŸ”„ í–¥í›„ MCP í™•ì¥ ê³„íš

### Phase 1: ì¶”ê°€ MCP í†µí•©

- **Twitter MCP**: ì‹¤ì‹œê°„ ì†Œì…œ íŠ¸ë Œë“œ
- **TikTok MCP**: ì‡¼íŠ¸í¼ íŠ¸ë Œë“œ ë¶„ì„
- **Instagram MCP**: ë¹„ì£¼ì–¼ íŠ¸ë Œë“œ ìˆ˜ì§‘

### Phase 2: ê³ ê¸‰ AI ê¸°ëŠ¥

- **GPT-4 Vision**: ì¸ë„¤ì¼ ë¶„ì„
- **Whisper API**: ìŒì„± ì½˜í…ì¸  ë¶„ì„
- **DALL-E**: ë§ì¶¤í˜• ì¸ë„¤ì¼ ìƒì„±

### Phase 3: ìë™í™” ë° í•™ìŠµ

- **AutoML**: ê°œì¸í™” ëª¨ë¸ ìë™ í•™ìŠµ
- **A/B Testing**: MCP ì›Œí¬í”Œë¡œìš° ìµœì í™”
- **Reinforcement Learning**: ì‚¬ìš©ì í”¼ë“œë°± ê¸°ë°˜ ê°œì„ 
