# 2. ê¸°ìˆ  ìŠ¤íƒ ë° ì•„í‚¤í…ì²˜ ìš”ì•½

> ìƒì„¸ ë¬¸ì„œ: [docs/basic/2.ê¸°ìˆ  ìŠ¤íƒ ë° ì•„í‚¤í…ì³.md](../basic/2.ê¸°ìˆ %20ìŠ¤íƒ%20ë°%20ì•„í‚¤í…ì³.md)

## ğŸ—ï¸ 4ê³„ì¸µ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client Layer   â”‚ -> â”‚  API Gateway    â”‚ -> â”‚ Service Layer   â”‚ -> â”‚   Data Layer    â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ Web Browser   â”‚    â”‚ â€¢ Railway       â”‚    â”‚ â€¢ Express.js    â”‚    â”‚ â€¢ Supabase      â”‚
â”‚ â€¢ Mobile App    â”‚    â”‚ â€¢ HTTPS/TLS     â”‚    â”‚ â€¢ MCP Clients   â”‚    â”‚ â€¢ PostgreSQL    â”‚
â”‚ â€¢ PWA           â”‚    â”‚ â€¢ Rate Limiting â”‚    â”‚ â€¢ Business Logicâ”‚    â”‚ â€¢ Redis Cache   â”‚
â”‚ â€¢ Service Workerâ”‚    â”‚ â€¢ Load Balancer â”‚    â”‚ â€¢ Auth Service  â”‚    â”‚ â€¢ File Storage  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1ï¸âƒ£ Client Layer (í”„ë ˆì  í…Œì´ì…˜ ê³„ì¸µ)

- **ëª©í‘œ**: ì‚¬ìš©ì ê²½í—˜ ìµœì í™” ë° í¬ë¡œìŠ¤ í”Œë«í¼ ì§€ì›

#### Vanilla JavaScript SPA ì„ íƒ ì´ìœ 

```javascript
// âŒ React/Vueê°€ ì•„ë‹Œ Vanilla JSë¥¼ ì„ íƒí•œ ì´ìœ 
const reasons = {
  performance: "Zero runtime overhead, ë²ˆë“¤ ì‚¬ì´ì¦ˆ ìµœì†Œí™”",
  control: "DOM ì¡°ì‘ ì™„ì „ ì œì–´, ì„¸ë°€í•œ ìµœì í™” ê°€ëŠ¥",
  simplicity: "ì˜ì¡´ì„± ìµœì†Œí™”, ë¹ ë¥¸ ë¡œë”©",
  pwa: "Service Workerì™€ ì™„ë²½ í†µí•©",
};

// âœ… Component ê¸°ë°˜ ì•„í‚¤í…ì²˜ (Web Components ì•„ë‹˜!)
class VideoCard extends Component {
  constructor(props) {
    super(props);
    this.state = {
      liked: false,
      viewed: false,
      thumbnail: props.video.thumbnail,
    };
  }

  render() {
    return `
      <div class="video-card" data-video-id="${this.props.video.id}">
        <img src="${this.state.thumbnail}" 
             loading="lazy" 
             class="thumbnail">
        <div class="video-info">
          <h3>${this.props.video.title}</h3>
          <span class="channel">${this.props.video.channel}</span>
        </div>
      </div>
    `;
  }
}
```

#### Hash-based Router

```javascript
// ê°„ë‹¨í•˜ê³  íš¨ìœ¨ì ì¸ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë¼ìš°íŒ…
class Router {
  constructor(routes) {
    this.routes = routes;
    window.addEventListener("hashchange", this.handleRoute.bind(this));
  }

  handleRoute() {
    const hash = window.location.hash.slice(1) || "/";
    const route = this.routes[hash];
    if (route) {
      document.getElementById("app").innerHTML = route.render();
    }
  }
}

const router = new Router({
  "/": new HomePage(),
  "/search": new SearchPage(),
  "/trending": new TrendingPage(),
  "/profile": new ProfilePage(),
});
```

#### PWA ìµœì í™”

```javascript
// Service Workerë¡œ ì˜¤í”„ë¼ì¸ ì§€ì›
const CACHE_VERSION = "v1.2.0";
const CACHE_STATIC = "static-cache";
const CACHE_DYNAMIC = "dynamic-cache";

self.addEventListener("fetch", (event) => {
  if (event.request.url.includes("/api/")) {
    // API ìš”ì²­: Network First with Cache Fallback
    event.respondWith(networkFirstStrategy(event.request));
  } else {
    // ì •ì  ë¦¬ì†ŒìŠ¤: Cache First
    event.respondWith(cacheFirstStrategy(event.request));
  }
});
```

### 2ï¸âƒ£ API Gateway (Railway ë°°í¬)

- **ëª©í‘œ**: ë³´ì•ˆ, ì„±ëŠ¥, í™•ì¥ì„± ë³´ì¥

#### Railway ì„ íƒ ì´ìœ 

```yaml
# railway.toml ì„¤ì •
[build]
  builder = "nixpacks"

[deploy]
  healthcheckPath = "/health"
  restartPolicyType = "on_failure"

[variables]
  NODE_ENV = "production"

# ì¥ì :
# 1. Zero-config ë°°í¬
# 2. ìë™ HTTPS ì ìš©
# 3. ê¸€ë¡œë²Œ CDN
# 4. ìë™ ìŠ¤ì¼€ì¼ë§
# 5. ë¹„ìš© íš¨ìœ¨ì  ($5/month ì‹œì‘)
```

#### ë³´ì•ˆ ë¯¸ë“¤ì›¨ì–´ ìŠ¤íƒ

```javascript
// ê³„ì¸µë³„ ë³´ì•ˆ ì ìš©
app.use(
  helmet({
    contentSecurityPolicy: {
      directives: {
        defaultSrc: ["'self'"],
        imgSrc: ["'self'", "https://i.ytimg.com", "https://yt3.ggpht.com"],
        connectSrc: ["'self'", "https://api.youtube.com"],
      },
    },
    crossOriginEmbedderPolicy: false, // YouTube ì„ë² ë“œë¥¼ ìœ„í•´
  })
);

app.use(
  cors({
    origin:
      process.env.NODE_ENV === "production"
        ? ["https://youtube-curator.railway.app"]
        : true,
    credentials: true,
  })
);

// Rate Limiting (ì‚¬ìš©ìë³„)
const rateLimiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15ë¶„
  max: 100, // ìš”ì²­ ì œí•œ
  message: { error: "Too many requests" },
});
```

### 3ï¸âƒ£ Service Layer (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)

- **ëª©í‘œ**: íš¨ìœ¨ì  API ê´€ë¦¬ ë° MCP í†µí•©

#### Express.js + Node.js ì„ íƒ ì´ìœ 

```javascript
// ì„±ëŠ¥ê³¼ ê°œë°œ ì†ë„ì˜ ê· í˜•
const advantages = {
  ecosystem: "í’ë¶€í•œ npm ìƒíƒœê³„",
  async: "Non-blocking I/Oë¡œ ë†’ì€ ë™ì‹œì„±",
  javascript: "í”„ë¡ íŠ¸ì—”ë“œì™€ ë™ì¼ ì–¸ì–´",
  rapid: "ë¹ ë¥¸ í”„ë¡œí† íƒ€ì´í•‘ ë° ê°œë°œ"
};

// ì„œë¹„ìŠ¤ ë ˆì´ì–´ êµ¬ì¡°
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ youtubeService.js      # YouTube API ê´€ë¦¬
â”‚   â”œâ”€â”€ mcpService.js          # MCP í´ë¼ì´ì–¸íŠ¸ í†µí•©
â”‚   â”œâ”€â”€ cacheService.js        # ìºì‹± ì „ëµ
â”‚   â”œâ”€â”€ authService.js         # ì¸ì¦/ì¸ê°€
â”‚   â””â”€â”€ analyticsService.js    # ì‚¬ìš©ì ë¶„ì„
```

#### YouTube API í• ë‹¹ëŸ‰ ìµœì í™” ì „ëµ

```javascript
// ìŠ¤ë§ˆíŠ¸ í• ë‹¹ëŸ‰ ë¶„ë°° (ì¼ì¼ 10,000 units)
const quotaDistribution = {
  popular_keywords: {
    units: 3000,        // 30% - 30ì¼ ì£¼ê¸° ìºì‹±
    strategy: "Long-term caching for top 100 keywords"
  },
  trending_keywords: {
    units: 1000,        // 10% - Bright Data ì‹¤ì‹œê°„ ë³´ê°•
    strategy: "Real-time trends with external data"
  },
  user_patterns: {
    units: 1000,        // 10% - ê°œì¸í™” í•™ìŠµ
    strategy: "User behavior analysis"
  },
  hourly_trends: {
    units: 1000,        // 10% - ì‹œê°„ëŒ€ë³„ íŠ¸ë Œë“œ
    strategy: "Time-based trend detection"
  },
  premium_realtime: {
    units: 2500,        // 25% - í”„ë¦¬ë¯¸ì—„ ì‹¤ì‹œê°„ ê²€ìƒ‰
    strategy: "Conversational AI search"
  },
  emergency_buffer: {
    units: 1500         // 15% - ê¸´ê¸‰ ìƒí™© ëŒ€ë¹„
    strategy: "Spike handling and cache misses"
  }
};

// API ë¹„ìš© ê³„ì‚° í•¨ìˆ˜
function calculateApiCost(operation, parts = []) {
  const costs = {
    'search.list': 100,
    'videos.list': 1 + (parts.length * 2),  // 1 + 2*parts
    'channels.list': 1 + (parts.length * 2)
  };
  return costs[operation] || 0;
}
```

#### ì§€ëŠ¥í˜• ì¿¼ë¦¬ ë¹Œë” (90% API ì ˆì•½)

```javascript
// Bright Data MCP + ì±„ë„ ì‚¬ì „ ìºì‹±ìœ¼ë¡œ API ì‚¬ìš©ëŸ‰ ê·¹ì  ì ˆì•½
async function intelligentSearch(query) {
  // 1ë‹¨ê³„: Bright Dataë¡œ ì›¹ ê²€ìƒ‰ (ë¬´ë£Œ)
  const webContext = await brightDataMCP.searchWeb(query);

  // 2ë‹¨ê³„: ì±„ë„/ì¸ë¬¼ ì¶”ì¶œ
  const entities = extractEntities(webContext);

  if (entities.channels.length > 0) {
    // 3ë‹¨ê³„: ì±„ë„ ê¸°ë°˜ ê²€ìƒ‰ (3 unitsë§Œ ì‚¬ìš©!)
    return await searchByChannels(entities.channels, query);
  } else {
    // 4ë‹¨ê³„: ì¼ë°˜ ê²€ìƒ‰ (100 units)
    return await fallbackSearch(query);
  }
}

// ì˜ˆì‹œ: "LCK ìµœì‹  ì˜ìƒ" â†’ T1, ì  ì§€ ì±„ë„ ê²€ìƒ‰ â†’ 3 unitsë§Œ ì‚¬ìš©
```

#### MCP í´ë¼ì´ì–¸íŠ¸ ì•„í‚¤í…ì²˜

```javascript
// 3ê°œ MCP ì„œë²„ í†µí•© ê´€ë¦¬
class MCPManager {
  constructor() {
    this.clients = {
      claude: new ClaudeMCP(process.env.ANTHROPIC_API_KEY),
      brightData: new BrightDataMCP(process.env.BRIGHT_DATA_KEY),
      supabase: new SupabaseMCP(process.env.SUPABASE_KEY),
    };
  }

  async executeWorkflow(userQuery) {
    // 1. Claude: ì¿¼ë¦¬ ë¶„ì„
    const analysis = await this.clients.claude.analyzeQuery(userQuery);

    // 2. Bright Data: íŠ¸ë Œë“œ ìˆ˜ì§‘
    const trends = await this.clients.brightData.getTrends(analysis.keywords);

    // 3. Supabase: ì‚¬ìš©ì íŒ¨í„´ ì¡°íšŒ
    const userPattern = await this.clients.supabase.getUserPattern(userId);

    // 4. í†µí•© ê²°ê³¼ ìƒì„±
    return this.synthesizeResults(analysis, trends, userPattern);
  }
}
```

### 4ï¸âƒ£ Data Layer (ë°ì´í„° ê´€ë¦¬)

- **ëª©í‘œ**: ê³ ì„±ëŠ¥ ë°ì´í„° ì²˜ë¦¬ ë° ì‹¤ì‹œê°„ ë™ê¸°í™”

#### Supabase ì„ íƒ ì´ìœ 

```javascript
// PostgreSQL + ì‹¤ì‹œê°„ ê¸°ëŠ¥ + ì¸ì¦ì„ í•˜ë‚˜ë¡œ
const advantages = {
  realtime: "WebSocket ê¸°ë°˜ ì‹¤ì‹œê°„ êµ¬ë…",
  auth: "Built-in ì¸ì¦ ì‹œìŠ¤í…œ",
  rls: "Row Level Securityë¡œ ë°ì´í„° ë³´ì•ˆ",
  edge: "Edge Functionsë¡œ ì„œë²„ë¦¬ìŠ¤ ë¡œì§",
  postgresql: "ê°•ë ¥í•œ ê´€ê³„í˜• DB + JSONB ì§€ì›",
};

// ì‹¤ì‹œê°„ íŠ¸ë Œë“œ êµ¬ë… ì˜ˆì‹œ
const supabase = createClient(url, key);

supabase
  .from("trending_keywords")
  .on("INSERT", (payload) => {
    // ìƒˆë¡œìš´ íŠ¸ë Œë“œ í‚¤ì›Œë“œ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
    updateTrendingUI(payload.new);
  })
  .subscribe();
```

#### ê³ ì„±ëŠ¥ ìºì‹± ì „ëµ

```javascript
// 4ë‹¨ê³„ ìºì‹± ì‹œìŠ¤í…œ
class CacheStrategy {
  constructor() {
    this.levels = {
      L1: new Map(), // ë©”ëª¨ë¦¬ (1MB, 1ë¶„)
      L2: new LRUCache(100), // LRU (10MB, 1ì‹œê°„)
      L3: new NodeCache(), // ë…¸ë“œ ìºì‹œ (100MB, 24ì‹œê°„)
      L4: "supabase", // DB ìºì‹œ (ë¬´ì œí•œ, 30ì¼)
    };
  }

  async get(key) {
    // L1 â†’ L2 â†’ L3 â†’ L4 ìˆœì„œë¡œ ì¡°íšŒ
    for (const [level, cache] of Object.entries(this.levels)) {
      const value = await this.getFromLevel(cache, key);
      if (value) {
        this.promoteToHigherLevels(key, value, level);
        return value;
      }
    }
    return null;
  }
}

// ìºì‹± TTL ì „ëµ
const cacheTTL = {
  popular_keywords: 30 * 24 * 60 * 60, // 30ì¼
  trending_keywords: 4 * 60 * 60, // 4ì‹œê°„
  user_patterns: 24 * 60 * 60, // 24ì‹œê°„
  video_metadata: 7 * 24 * 60 * 60, // 7ì¼
  search_results: 2 * 60 * 60, // 2ì‹œê°„
};
```

## ğŸ”§ í•µì‹¬ ê¸°ìˆ  ê²°ì • ì‚¬í•­

### Frontend: ì™œ Vanilla JSì¸ê°€?

```javascript
// ì„±ëŠ¥ ë¹„êµ
const bundleSizes = {
  react: "42KB (React) + 2KB (ReactDOM) = 44KB",
  vue: "34KB (Vue 3)",
  vanilla: "0KB (framework) + 15KB (our code) = 15KB",
};

// ë¡œë”© ì†ë„ ë¹„êµ
const loadingTime = {
  react: "1.2ì´ˆ (framework íŒŒì‹± + ì•± ì´ˆê¸°í™”)",
  vue: "0.9ì´ˆ",
  vanilla: "0.3ì´ˆ (ì¦‰ì‹œ ì‹¤í–‰)",
};
```

### Backend: ì™œ Node.js + Expressì¸ê°€?

```javascript
// ê°œë°œ ìƒì‚°ì„±ê³¼ ì„±ëŠ¥ì˜ ê· í˜•
const comparison = {
  node_express: {
    pros: ["JavaScript í†µì¼", "ë¹ ë¥¸ ê°œë°œ", "í’ë¶€í•œ ìƒíƒœê³„"],
    cons: ["CPU ì§‘ì•½ì  ì‘ì—… í•œê³„"],
    fit: "I/O ìœ„ì£¼ ì‘ì—…ì— ìµœì  (API í˜¸ì¶œ, DB ì¿¼ë¦¬)",
  },
  python_fastapi: {
    pros: ["AI/ML ìƒíƒœê³„", "íƒ€ì… íŒíŠ¸"],
    cons: ["ë³„ë„ ì–¸ì–´ í•™ìŠµ", "ë°°í¬ ë³µì¡ì„±"],
    fit: "ë°ì´í„° ê³¼í•™ ì‘ì—…ì— ìµœì ",
  },
};
```

### Database: ì™œ Supabaseì¸ê°€?

```javascript
// ê°œë°œ ì†ë„ì™€ ê¸°ëŠ¥ì˜ ê· í˜•
const comparison = {
  supabase: {
    pros: ["ì‹¤ì‹œê°„ ê¸°ëŠ¥", "ë‚´ì¥ ì¸ì¦", "PostgreSQL", "Edge Functions"],
    cons: ["ë²¤ë” ì¢…ì†ì„±", "ì œí•œëœ ì»¤ìŠ¤í„°ë§ˆì´ì§•"],
    fit: "ë¹ ë¥¸ MVP ê°œë°œ + í™•ì¥ ê°€ëŠ¥",
  },
  mongodb_atlas: {
    pros: ["NoSQL ìœ ì—°ì„±", "ìˆ˜í‰ í™•ì¥"],
    cons: ["ì‹¤ì‹œê°„ ê¸°ëŠ¥ ë¶€ì¡±", "ì¸ì¦ ì‹œìŠ¤í…œ ë³„ë„ êµ¬ì¶•"],
    fit: "ë¹„ì •í˜• ë°ì´í„° ì¤‘ì‹¬ ì•±",
  },
};
```

## ğŸ“Š ì„±ëŠ¥ ìµœì í™” ì „ëµ

### 1. API ìµœì í™”

```javascript
// Before: ê¸°ë³¸ ê²€ìƒ‰ (100 units)
await youtube.search.list({
  q: "ë¨¹ë°©",
  type: "video",
  videoDuration: "short",
});

// After: ì§€ëŠ¥í˜• ê²€ìƒ‰ (3 units)
const channels = await brightData.findChannels("ë¨¹ë°©");
await youtube.videos.list({
  channelId: channels[0].id,
  part: "snippet",
});

// 97% ë¹„ìš© ì ˆì•½!
```

### 2. í”„ë¡ íŠ¸ì—”ë“œ ìµœì í™”

```javascript
// Lazy Loading + Virtual Scrolling
class VideoList {
  constructor() {
    this.observer = new IntersectionObserver(this.loadMore.bind(this));
    this.virtualizedView = true;
  }

  render() {
    // í™”ë©´ì— ë³´ì´ëŠ” ì•„ì´í…œë§Œ ë Œë”ë§
    const visibleItems = this.getVisibleItems();
    return visibleItems.map((item) => new VideoCard(item).render());
  }
}

// Image Optimization
const imageOptimizer = {
  webp: "Chrome/Android ì§€ì›",
  avif: "ìµœì‹  ë¸Œë¼ìš°ì € ì§€ì›",
  fallback: "JPEG/PNG",
};
```

### 3. ìºì‹± íš¨ìœ¨ì„±

```javascript
// ìºì‹œ íˆíŠ¸ìœ¨ ëª©í‘œ: 85%
const cacheMetrics = {
  current: {
    l1_hit_rate: 60, // ë©”ëª¨ë¦¬ ìºì‹œ
    l2_hit_rate: 25, // LRU ìºì‹œ
    l3_hit_rate: 15, // ë…¸ë“œ ìºì‹œ
    l4_hit_rate: 5, // DB ìºì‹œ
  },
  total_hit_rate: 85, // ì „ì²´ ìºì‹œ ì ì¤‘ë¥ 
  miss_rate: 15, // ì‹¤ì œ API í˜¸ì¶œ
};
```

## ğŸš€ í™•ì¥ì„± ë° ë°°í¬ ì „ëµ

### ìŠ¤ì¼€ì¼ë§ ê³„íš

```javascript
// ì‚¬ìš©ì ì¦ê°€ì— ë”°ë¥¸ ì¸í”„ë¼ í™•ì¥
const scalingPlan = {
  "1k_users": {
    infrastructure: "Railway Hobby ($5/month)",
    database: "Supabase Free Tier",
    cdn: "Railway ë‚´ì¥ CDN",
  },
  "10k_users": {
    infrastructure: "Railway Pro ($20/month)",
    database: "Supabase Pro ($25/month)",
    cdn: "Cloudflare (ë¬´ë£Œ)",
  },
  "100k_users": {
    infrastructure: "Railway Team ($100/month)",
    database: "Supabase Team ($599/month)",
    cdn: "Cloudflare Pro ($20/month)",
    additional: "Redis ìºì‹œ ì„œë²„ ì¶”ê°€",
  },
};
```

### CI/CD íŒŒì´í”„ë¼ì¸

```yaml
# .github/workflows/deploy.yml
name: Deploy to Railway
on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: "18"
      - run: npm ci
      - run: npm run test
      - run: npm run build
      - uses: railway/cli@v1
        with:
          command: deploy
        env:
          RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
```

## ğŸ”’ ë³´ì•ˆ ë° ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

### ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

- âœ… HTTPS ê°•ì œ ì ìš© (Railway ìë™)
- âœ… CSP (Content Security Policy) ì„¤ì •
- âœ… Rate Limiting (ì‚¬ìš©ìë³„/IPë³„)
- âœ… JWT í† í° ë³´ì•ˆ (HTTPOnly ì¿ í‚¤)
- âœ… SQL Injection ë°©ì–´ (Parameterized Queries)
- âœ… XSS ë°©ì–´ (Input Sanitization)

### ì„±ëŠ¥ ë©”íŠ¸ë¦­

```javascript
// ëª©í‘œ ì„±ëŠ¥ ì§€í‘œ
const performanceTargets = {
  api_response_time: "< 500ms",
  page_load_time: "< 2ì´ˆ",
  cache_hit_rate: "> 85%",
  uptime: "> 99.9%",
  mobile_performance: "> 90ì  (Lighthouse)",
};
```
